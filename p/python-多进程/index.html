<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="串行执行、并发执行、并行执行 串行执行、并发执行和并行执行是计算机程序执行方式的三个不同阶段，它们的发展历史与计算机硬件和软件的进步紧密相关。\n串行执行 串行执行属于最早期的程序执行方式，是指任务按顺序一个接一个地执行在串行执行中，一个任务必须等待前一个任务完成后才能开始执行。这种执行方式简单、易于控制，但效率较低，特别是在处理大量任务时，因为CPU的云算能力没有得到充分利用。在早期计算机系统中非常普遍，因为当时的硬件资源有限，且CPU的能力远不如现在，无法同时执行多个任务，并且大部分计算机都只有一个CPU。因此程序设计通常采用串行执行，在这一时期计算机主要用于科学计算和军事目的，任务通常是简单的、顺序的，不需要复杂的并发或并行处理。\n">
<title>Python-多进程</title>

<link rel='canonical' href='https://UPPO8.github.io/Mybolg/p/python-%E5%A4%9A%E8%BF%9B%E7%A8%8B/'>

<link rel="stylesheet" href="/Mybolg/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="Python-多进程">
<meta property='og:description' content="串行执行、并发执行、并行执行 串行执行、并发执行和并行执行是计算机程序执行方式的三个不同阶段，它们的发展历史与计算机硬件和软件的进步紧密相关。\n串行执行 串行执行属于最早期的程序执行方式，是指任务按顺序一个接一个地执行在串行执行中，一个任务必须等待前一个任务完成后才能开始执行。这种执行方式简单、易于控制，但效率较低，特别是在处理大量任务时，因为CPU的云算能力没有得到充分利用。在早期计算机系统中非常普遍，因为当时的硬件资源有限，且CPU的能力远不如现在，无法同时执行多个任务，并且大部分计算机都只有一个CPU。因此程序设计通常采用串行执行，在这一时期计算机主要用于科学计算和军事目的，任务通常是简单的、顺序的，不需要复杂的并发或并行处理。\n">
<meta property='og:url' content='https://UPPO8.github.io/Mybolg/p/python-%E5%A4%9A%E8%BF%9B%E7%A8%8B/'>
<meta property='og:site_name' content='UPPO Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2024-10-15T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2024-10-15T00:00:00&#43;00:00'/><meta property='og:image' content='https://UPPO8.github.io/Mybolg/images/PythonCourse/R-C.png' />
<meta name="twitter:title" content="Python-多进程">
<meta name="twitter:description" content="串行执行、并发执行、并行执行 串行执行、并发执行和并行执行是计算机程序执行方式的三个不同阶段，它们的发展历史与计算机硬件和软件的进步紧密相关。\n串行执行 串行执行属于最早期的程序执行方式，是指任务按顺序一个接一个地执行在串行执行中，一个任务必须等待前一个任务完成后才能开始执行。这种执行方式简单、易于控制，但效率较低，特别是在处理大量任务时，因为CPU的云算能力没有得到充分利用。在早期计算机系统中非常普遍，因为当时的硬件资源有限，且CPU的能力远不如现在，无法同时执行多个任务，并且大部分计算机都只有一个CPU。因此程序设计通常采用串行执行，在这一时期计算机主要用于科学计算和军事目的，任务通常是简单的、顺序的，不需要复杂的并发或并行处理。\n"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://UPPO8.github.io/Mybolg/images/PythonCourse/R-C.png' />
    <link rel="shortcut icon" href="/Mybolg/1828643.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="切换菜单">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/Mybolg/">
                
                    
                    
                    
                        
                        <img src="/Mybolg/img/100_hu17204809037550521928.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">😊</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/Mybolg">UPPO Blog</a></h1>
            <h2 class="site-description">欢迎来到UPPO的博客</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/402008155'
                        target="_blank"
                        title="BiliBili"
                        rel="me"
                    >
                        
                        
                            <svg class="icon" style="width: 1em;height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1385"><path d="M125.258667 395.2c-14.016 105.909333-6.4 234.293333-0.277334 337.504l0.021334 0.234667c3.413333 57.450667 28.405333 101.322667 72.277333 126.912 33.429333 19.498667 70.538667 25.109333 105.642667 28.266666 42.261333 3.808 120.736 7.861333 214.4 7.882667 93.685333-0.021333 172.16-4.085333 214.410666-7.893333 35.114667-3.146667 72.213333-8.757333 105.653334-28.266667 43.872-25.578667 68.864-69.461333 72.288-126.901333V732.8c6.133333-103.232 13.76-231.669333-0.277334-337.6-13.866667-104.864-91.274667-135.264-131.008-136.810667a3286.506667 3286.506667 0 0 0-106.026666-5.258666c9.813333-10.997333 25.898667-30.058667 37.525333-49.109334q17.888-29.301333-11.093333-53.717333-14.613333-12.448-28.405334-11.584-15.306667 0.96-29.578666 18.293333c-20.437333 24.832-49.973333 72.16-63.306667 94.005334a4644.352 4644.352 0 0 0-51.072-0.277334l-69.28 0.277334c-13.333333-21.845333-42.858667-69.173333-63.306667-94.005334q-14.282667-17.333333-29.578666-18.293333-13.781333-0.853333-28.394667 11.584-28.992 24.416-11.114667 53.717333c11.637333 19.050667 27.712 38.112 37.525334 49.109334-35.370667 1.173333-70.72 2.933333-106.026667 5.258666-39.722667 1.536-117.12 31.946667-130.997333 136.810667z" fill="#FFFFFF" p-id="1386"></path><path d="M124.981333 732.704c-6.122667-103.210667-13.738667-231.594667 0.277334-337.504 13.866667-104.864 91.274667-135.264 130.997333-136.810667 35.306667-2.325333 70.656-4.085333 106.026667-5.258666-9.813333-10.997333-25.888-30.058667-37.525334-49.109334q-17.888-29.301333 11.114667-53.717333 14.613333-12.437333 28.394667-11.584 15.296 0.96 29.578666 18.293333c20.448 24.832 49.973333 72.16 63.306667 94.005334l69.28-0.277334c17.28 0 34.293333 0.106667 51.072 0.277334 13.333333-21.845333 42.869333-69.173333 63.306667-94.005334q14.272-17.333333 29.578666-18.293333 13.781333-0.853333 28.405334 11.584 28.981333 24.416 11.093333 53.717333c-11.626667 19.050667-27.701333 38.112-37.514667 49.109334 36.928 1.258667 72.341333 3.008 106.026667 5.258666 39.722667 1.536 117.12 31.946667 130.997333 136.810667 14.026667 105.930667 6.4 234.368 0.288 337.6l-0.010666 0.138667c-3.413333 57.44-28.416 101.322667-72.288 126.912-33.44 19.498667-70.538667 25.109333-105.642667 28.266666-42.261333 3.797333-120.736 7.861333-214.410667 7.882667-93.674667-0.021333-172.16-4.074667-214.410666-7.893333-35.104-3.146667-72.213333-8.757333-105.642667-28.266667-43.872-25.578667-68.864-69.450667-72.277333-126.901333l-0.021334-0.234667z m650.4-401.141333l-1.386666-0.064c-74.474667-4.981333-157.76-7.509333-247.562667-7.509334h-18.208c-89.792 0-173.077333 2.528-247.552 7.52l-1.386667 0.064c-0.106667 0-12.181333 1.077333-24.928 8.746667-19.594667 11.754667-31.605333 33.429333-35.701333 64.384-13.12 99.104-5.706667 223.765333 0.245333 323.946667 3.829333 64.373333 43.498667 80.469333 110.741334 86.517333 14.037333 1.28 89.962667 7.562667 207.690666 7.584 117.738667-0.021333 193.664-6.314667 207.701334-7.584 67.242667-6.048 106.922667-22.144 110.741333-86.528 5.952-100.170667 13.354667-224.832 0.245333-323.936-4.096-30.965333-16.106667-52.629333-35.712-64.394667-12.746667-7.658667-24.821333-8.746667-24.928-8.746666zM249.941333 548.906667c7.488 15.146667 25.973333 21.418667 41.269334 13.973333 0.608-0.298667 61.568-29.706667 134.869333-51.946667 16.298667-4.906667 25.482667-21.994667 20.48-38.122666-4.992-16.138667-22.261333-25.194667-38.56-20.234667-77.92 23.637333-141.28 54.208-143.936 55.498667a30.368 30.368 0 0 0-14.112 40.832z m493.525334 13.973333c15.285333 7.402667 33.76 1.152 41.248-13.973333a30.368 30.368 0 0 0-14.101334-40.842667c-2.666667-1.290667-66.026667-31.861333-143.946666-55.488-16.288-4.949333-33.536 4.117333-38.506667 20.234667-4.992 16.106667 4.16 33.173333 20.448 38.122666 73.045333 22.154667 134.24 51.637333 134.858667 51.946667zM575.008 679.509333c51.658667 0 65.76-67.530667 66.325333-70.410666a14.645333 14.645333 0 0 0-11.637333-17.205334 14.773333 14.773333 0 0 0-17.397333 11.52c-0.106667 0.469333-10.133333 46.805333-37.290667 46.805334-29.098667 0-44.544-40.64-44.693333-41.002667a14.805333 14.805333 0 0 0-13.834667-9.674667h-0.074667c-6.186667 0-11.701333 3.797333-13.866666 9.525334-4.032 10.666667-20.330667 41.141333-41.653334 41.141333-20.394667 0-35.210667-35.498667-38.794666-47.936a14.826667 14.826667 0 0 0-18.208-9.952 14.634667 14.634667 0 0 0-10.282667 17.898667c2.016 7.093333 21.024 69.290667 67.306667 69.290666 25.834667 0 44.213333-18.133333 55.530666-34.496 11.562667 16.394667 30.656 34.496 58.570667 34.496z" fill="#00AEEC" p-id="1387"></path></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/ilovegta/ilovegta.github.io'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/Mybolg/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>主页</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Mybolg/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>搜索</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Mybolg/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>归档</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Mybolg/%E5%85%B3%E4%BA%8E/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>关于</span>
            </a>
        </li>
        
        
        <li >
            <a href='/Mybolg/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>暗色模式</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">目录</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#串行执行并发执行并行执行">串行执行、并发执行、并行执行</a>
      <ol>
        <li><a href="#串行执行">串行执行</a></li>
        <li><a href="#并发执行">并发执行</a></li>
        <li><a href="#并行执行">并行执行</a></li>
      </ol>
    </li>
    <li><a href="#io密集型任务与cpu密集型任务">I/O密集型任务与CPU密集型任务</a>
      <ol>
        <li><a href="#io密集型任务">I/O密集型任务</a></li>
        <li><a href="#cpu密集型任务">CPU密集型任务</a></li>
        <li><a href="#对程序执行的影响">对程序执行的影响</a></li>
      </ol>
    </li>
    <li><a href="#多进程的概念">多进程的概念</a>
      <ol>
        <li><a href="#进程介绍">进程介绍</a></li>
        <li><a href="#进程和程序的关系">进程和程序的关系</a></li>
        <li><a href="#进程的种类">进程的种类</a></li>
        <li><a href="#pid">PID</a></li>
        <li><a href="#多进程的概念-1">多进程的概念</a></li>
      </ol>
    </li>
    <li><a href="#创建多进程">创建多进程</a></li>
    <li><a href="#进程间通信">进程间通信</a>
      <ol>
        <li><a href="#管道pipe">管道(pipe)</a>
          <ol>
            <li><a href="#创建管道">创建管道</a></li>
            <li><a href="#管道方法">管道方法</a></li>
            <li><a href="#使用管道">使用管道</a></li>
            <li><a href="#管道特点">管道特点</a></li>
            <li><a href="#注意事项">注意事项</a></li>
          </ol>
        </li>
        <li><a href="#消息队列queue">消息队列（Queue）</a>
          <ol>
            <li><a href="#创建消息队列">创建消息队列</a></li>
            <li><a href="#消息队列的方法">消息队列的方法</a></li>
            <li><a href="#在进程中使用消息队列">在进程中使用消息队列</a></li>
            <li><a href="#消息队列的特点">消息队列的特点</a></li>
          </ol>
        </li>
        <li><a href="#共享内存">共享内存</a>
          <ol>
            <li><a href="#创建共享内存">创建共享内存</a></li>
            <li><a href="#共享内存的方法">共享内存的方法</a></li>
            <li><a href="#共享内存的使用">共享内存的使用</a></li>
            <li><a href="#共享内存的特点">共享内存的特点</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#进程同步">进程同步</a>
      <ol>
        <li><a href="#锁">锁</a>
          <ol>
            <li><a href="#互斥锁">互斥锁</a></li>
            <li><a href="#递归锁">递归锁</a></li>
          </ol>
        </li>
        <li><a href="#信号量">信号量</a></li>
        <li><a href="#事件">事件</a></li>
      </ol>
    </li>
    <li><a href="#进程池">进程池</a>
      <ol>
        <li><a href="#为什么使用进程池">为什么使用进程池</a></li>
        <li><a href="#进程池的创建">进程池的创建</a>
          <ol>
            <li><a href="#使用multiprocessing库">使用multiprocessing库</a></li>
            <li><a href="#使用concurrentfutures库">使用concurrent.futures库</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/Mybolg/p/python-%E5%A4%9A%E8%BF%9B%E7%A8%8B/">
                
                    <img src="/Mybolg/images/PythonCourse/R-C.png" loading="lazy" alt="Featured image of post Python-多进程" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/Mybolg/categories/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" style="background-color: #2a9d8f; color: #fff;">
                学习记录
            </a>
        
            <a href="/Mybolg/categories/python/" style="background-color: #2a9d8f; color: #fff;">
                Python
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/Mybolg/p/python-%E5%A4%9A%E8%BF%9B%E7%A8%8B/">Python-多进程</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Oct 15, 2024</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="串行执行并发执行并行执行">串行执行、并发执行、并行执行
</h2><p>串行执行、并发执行和并行执行是计算机程序执行方式的三个不同阶段，它们的发展历史与计算机硬件和软件的进步紧密相关。</p>
<h3 id="串行执行">串行执行
</h3><p>串行执行属于最早期的程序执行方式，是指任务按顺序一个接一个地执行在串行执行中，一个任务必须等待前一个任务完成后才能开始执行。这种执行方式简单、易于控制，但效率较低，特别是在处理大量任务时，因为CPU的云算能力没有得到充分利用。在早期计算机系统中非常普遍，因为当时的硬件资源有限，且CPU的能力远不如现在，无法同时执行多个任务，并且大部分计算机都只有一个CPU。因此程序设计通常采用串行执行，在这一时期计算机主要用于科学计算和军事目的，任务通常是简单的、顺序的，不需要复杂的并发或并行处理。</p>
<p>串行执行具有以下几个特点:</p>
<ol>
<li><strong>顺序性</strong>:任务必须按照一定的顺序执行，一个任务完成后才能开始下一个任务。</li>
<li><strong>易于管理</strong>:由于任务按顺序执行，因此管理和调试相对简单。</li>
<li><strong>资源利用率低</strong>:在执行单个任务时，CPU的运算能力没有得到充分利用，可能导致效率低下。</li>
</ol>
<h3 id="并发执行">并发执行
</h3><p>随着计算机技术的发展和多用户需求的出现，单一串行执行方式逐渐显得力不从心。此时操作系统引入了进程的概念，且它允许多个程序在内存中同时存在，操作系统负责调度这些程序，通过时间片轮转等技术使得它们可以交替使用CPU，从而达到一种看似并发的效果。这一技术提高了CPU的利用率，因为当一个程序等待I/0操作时，CPU可以切换到另一个程序执行。这一时期，计算机开始被广泛应用于商业和科学领域，需要处理更多的数据和更复杂的任务。</p>
<p>并发执行具有以下几个特点:</p>
<ol>
<li><strong>效率提高</strong>:通过在不同的任务之间切换，提高了CPU的利用率</li>
<li><strong>响应性增强</strong>:在交互式应用中，可以提高用户体验，比如用户在等待某个计算密集型任务的同时还可以进行其他操作。</li>
<li><strong>复杂性增加</strong>:并发编程需要处理诸如同步、死锁等问题，增加了开发难度。</li>
</ol>
<h3 id="并行执行">并行执行
</h3><p>随着晶体管和集成电路技术的进步，计算机的处理器能力得到了显著提升，并且制造出了包含多个处理器的计算机系统，这促进了并行计算的发展。并行执行能够显著提高计算机处理大量数据和复杂计算的能力，特别是在科学研究、天气预报、数据分析等领域。随着时间的发展，并行计算逐渐成为高性能计算(HPC)的核心技术，并行处理技术也在多核处理器和分布式系统中得到了广泛应用。</p>
<p>并行执行具有以下几个特点:</p>
<ol>
<li><strong>高性能</strong>:通过将任务分解为多个子任务并分配给不同的处理器执行，可以显著提高执行速度.</li>
<li><strong>复杂性高</strong>:并行编程通常需要对算法进行重新设计以支持并行化，同时还需要考虑数据共享、同步等问题。</li>
<li>可扩展性：并行系统的设计往往考虑到了将来扩展的可能性，可以以通过增加处理器数量来提高性能。</li>
</ol>
<h2 id="io密集型任务与cpu密集型任务">I/O密集型任务与CPU密集型任务
</h2><p>IO密集型任务和CPU密集型任务时根据任务执行时主要消耗的资源类型来分类的。</p>
<h3 id="io密集型任务">I/O密集型任务
</h3><p>10密集型任务是指那些任务执行过程中，大部分时间花费在输入/输出操作上，而不是CPU计算。这些任务的性能瓶颈通常在于磁盘读写、网络通信或用户输入等10操作的速度。以下是I0密集型任务的特点:</p>
<ol>
<li>等待时间:任务大部分时间在等待10操作完成。</li>
<li>CPU使用率:CPU使用率通常不高，因为CPU在等待I0操作完成期间常常处于空闲状态。</li>
<li>并发优势:IO密集型任务可以通过并发执行来提高效率，因为在等待一个IO操作完成时，CPU可以切换到另一个任务执行。</li>
</ol>
<p>比如：文件处理、网络请求处理、数据库操作等。</p>
<h3 id="cpu密集型任务">CPU密集型任务
</h3><p>CPU密集型任务是指大部分时间用于CPU计算的任务，设计大量的运算、判断和数据处理。这些任务的性能瓶颈通常在于CPU的计算能力。以下是CPU密集型任务的特点：</p>
<ol>
<li>计算时间：任务大部分在进行计算</li>
<li>CPU使用率：CPU使用率通常很高，因为任务需要大量的CPU资源</li>
<li>CPU密集型任务可以通过并行执行在不同的处理器核心上不同时运行来提高性能。</li>
</ol>
<h3 id="对程序执行的影响">对程序执行的影响
</h3><ol>
<li>对于IO密集型任务，多线程通常是一个较好的选择，因为它可以在单个进程内有效地处理多个IO操作，因为进程间切换的开销而降低效率。</li>
<li>对于CPU密集型任务，多进程可以更好地利用多核CPU的能力，因为每个进程可以在不同的核心上运行，从而提真整休的处理速度。</li>
</ol>
<h2 id="多进程的概念">多进程的概念
</h2><h3 id="进程介绍">进程介绍
</h3><p><strong>进程</strong>:进程就是程序的一次执行过程，就是一个正在执行的任务，一段程序的每一次运行都会产生一个或多个进程。进程是有生命周期的，大部分会随着程序的运行而创建，随着程序的结束而终止，也可以去手动结束进程。在操作系统中，进程是操作系统进行资源分配和调度的基本单位。每个进程都有自己的私有地址空间、执行堆栈、程序计数器、局部变量以及其他系统资源(如文件描述符、网络连接等)等。通俗的说，一个正在运行的程序就是一个进程，比如QQ、微信等，但也有可能这个程序会生成多个进程。</p>
<h3 id="进程和程序的关系">进程和程序的关系
</h3><p><strong>进程</strong>:进程是程序的一次执行过程，它是动态的，具备生命周期，在程序运行时存在，程序执行完毕及用户主动结束、系统错误等都会导致进程结束。</p>
<p><strong>程序</strong>:程序是静态的，没有生命周期，在磁盘上存放，由一系列指令和数据组成的文件，这些文件可以被操作系统加载到内存中并执行。</p>
<h3 id="进程的种类">进程的种类
</h3><p>在Windows操作系统中，进程可以根据其创建方式和执行环境被分为几种类型。以下是一些常见的Windows进程类型:</p>
<ol>
<li>
<p><strong>系统进程</strong>：<br>
这些进程是操作系统启动时由系统本身创建的，它们负责管理系统的核心功能，如内存管理、设备驱动程序、安全性和其他系统级服务。<br>
例如:Isass.exe(本地安全认证子系统服务)、wininit,exe(Windows初始化进程)。</p>
</li>
<li>
<p>**服务进程(Service Process)：<br>
这些进程通常在系统启动时或按需启动，它们在后台运行，提供网络、安全、系统维护等服务，通常不直接与用户交互。<br>
例如:DHCP client(管理IP地址分配)</p>
</li>
<li>
<p>用户进程(User Process):<br>
这些是由用户启动的应用程序创建的进程，用于执行特定任务，如文字处理、网页浏览、游戏等。<br>
例如:winword.exe(Microsoft Word)、chrome.exe(Google Chrome浏览器)。</p>
</li>
<li>
<p>交互式进程(Interactive Process):<br>
这些是与用户交互的进程，它们通常在用户登录并直接与操作系统交互时运行。<br>
例如:命令提示符(cmd.exe)或PowerShell(powershe11.exe)。</p>
</li>
</ol>
<h3 id="pid">PID
</h3><p>PID是“进程标识符”(Process ldentifier)的缩写，它是一个由操作系统分配给每个进程的唯一数字(大于等于0)。在操作系统中，每个进程都会被赋予一个唯一的PID，以便系统可以追踪和管理这些进程。</p>
<ol>
<li>唯一性:在一个操作系统中，每个正在运行的进程都有一个唯一的PID。即使在进程结束后，该PID通常也不会立即被重新分配给其他进程，以避免混淆。</li>
<li>进程管理:操作系统使用PID来识别和管理进程。例如，可以使用PID来发送信号给进程(如终止信号)、检查进程的状态、或者调整进程的优先级。</li>
<li>系统资源:PID还用于关联进程使用的系统资源，如打开的文件、网络连接和内存分配。</li>
<li>父进程与子进程:每个进程除了有自己的PID外，还有一个与之关联的父PID(PPID)。父PID是指启动该进程的进程的PID。</li>
<li>工具和命令:在命令行界面中，可以使用各种工具和命令来査看和管理进程，如 ps(Unix-ike系统)task1ist(Windows)等，这些工具通常会显示进程的PID。</li>
</ol>
<p>kil命令:在Windows中，可以在CMD中通过ki+PID 来终止该进程的运行。</p>
<h3 id="多进程的概念-1">多进程的概念
</h3><p>多进程(Multiprocessing)是指在同一时间内同时执行多个程序的技术或能力，每个进程都有自己的内存空间.文件描述符及其他系统资源。以下是多进程的一些特点:</p>
<ol>
<li>并发执行:多进程可以在多核或多处理器系统上实现真正的并行执行，即不同的进程可以在不同的CPU核心上同时运行。</li>
<li>资源分配:每个进程通常拥有独立的内存空间，这意味着它们不共享内存，这减少了资源共享带来的复杂性和潜在的问题。</li>
<li>独立性:全局变量在多个进程中不共享资源，进程之间的数据是独立的，默认是互不影响的。且由于进程间相对独立，一个进程的失败通常不会影响到其他进程，这提高了系统的稳定性和可靠性。</li>
<li>进程间通信(IPC):进程间通信机制(如管道、消息队列、共享内存、信号量等)用于允许进程之间交换数据和同步操作。</li>
</ol>
<h2 id="创建多进程">创建多进程
</h2><p>在Python中，multiprocessing库提供了创建和管理进程的方法，它允许程序员创建进程，并提供了一系列的API来支持进程间数据共享、同步和通信。
在Python中，使用multiprocessing中的Process类来创建子进程，Process类创建对象时的参数为:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{},</span><span class="o">*</span><span class="p">,</span><span class="n">daemon</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>以下是各个参数的说明:</p>
<ol>
<li>group:通常不使用，是为将来可能的扩展预留的。</li>
<li>target:表示调用对象，即子进程要执行的任务。这个参数通常是一个函数的名字</li>
<li>name:进程的名称。默认情况下，进程名称为Process-N，其中N是进程的序号。可以通过这个参数来指定一个自定义的名称。</li>
<li>args:表示调用 target函数时传递的参数元组，</li>
<li>kwargs:表示调用target函数时传递的参数字典。</li>
<li>daemon:如果设置为True，则子进程将是一个守护进程。当主进程结束时，所有守护进程都将被终止。默认值为 None ，表示继承当前进程的守护进程设置。</li>
</ol>
<p>创建的对象也拥有一些方法，分别是:</p>
<ol>
<li>start():启动进程。这将执行在创建process对象时指定的target函数，调用start时会自动调用run。</li>
<li>run():此方法用于定义进程启动时执行的操作。默认情况下，它调用传递给 target 参数的函数。如果</li>
<li>join([timeout]):主进程等待子进程终止或直到达到指定的超时时间。如果 timeout 被省略或为 None，则主进程将一直停留在这里。</li>
<li>is_a1ive():返回一个布尔值，表示进程是否仍然在运行。</li>
<li>terminate():强行终止进程，且不会进行任何清理操作。 如果该进程创建了子进程，那么这个子进程就变成了僵尸进程，如果p还保存了一个锁，那么这个锁也不会被释放，会变成死锁。</li>
<li>ki11():终止进程。在Unix上，这是通过发送SIGKILL信号实现的;在Windows上，则是通过调用TerminateProcess .</li>
<li>c1ose():关闭进程。此方法释放Process对象所持有的资源，如果子进程仍在进行，调用此方法将是错误的。</li>
</ol>
<p>除此之外，还有属性:</p>
<ol>
<li>name:返回或设置进程的名称。</li>
<li>pid:返回进程的PID。</li>
<li>exitcode:返回进程的退出代码，如果进程未结束，就返回None，负值-N表示子进程被信号N终止，正常终
止返回0。</li>
<li>authkey:返回或设置进程间通信的密钥，用于进程间通信的身份认证，了解即可。</li>
</ol>
<p>PID获取示例：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Process</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">say</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;子PID：&#34;</span><span class="p">,</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;父PID：&#34;</span><span class="p">,</span><span class="n">os</span><span class="o">.</span><span class="n">getppid</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span> <span class="o">=</span> <span class="n">say</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;main PID:&#39;</span><span class="p">,</span><span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">p1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="进程间通信">进程间通信
</h2><p>进程间通信(Inter-Process Communication,IPC)是指在不同进程之间传送数据或信号的一些方法。在多进程程序中，IPC是非常重要的，因为它允许进程协同工作、共享数据或同步操作。以下是几种常见的进程间通信机制:</p>
<h3 id="管道pipe">管道(pipe)
</h3><p>管道是一种在父子进程间或兄弟进程间进行通信的机制。Python的mu1tiprocessing 模块提供了Pipe()函数可以用来创建管道。</p>
<h4 id="创建管道">创建管道
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">parent_conn</span><span class="p">,</span><span class="n">child_conn</span><span class="o">=</span><span class="n">pipe</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>使用 multiprocessing.Pipe()可以创建一个管道。这个函数返回一个由两个连接对象组成的元组，这两个对象分别代表管道的两端。默认情况下，管道是双向的，每个端点都可以即读又写。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Process</span><span class="p">,</span> <span class="n">Pipe</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 创建一个管道</span>
</span></span><span class="line"><span class="cl"><span class="n">parent_conn</span><span class="p">,</span><span class="n">child_conn</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="管道方法">管道方法
</h4><p>在上面的例子中，parent_conn和child_conn都是管道对象，它们都拥有共同的方法:</p>
<ol>
<li>send(obj):发送一个对象到管道的另一端。这个对象必须是可序列化的。</li>
<li>recv():从管道的另一端接收一个对象。该方法是阻塞的。</li>
<li>close():关闭管道连接。当不再需要管道时，应该调用这个方法来释放资源。</li>
<li>fileno():返回由连接对象使用的文件描述符。</li>
<li>poll(timeout):返回连接对象中是否有可以读取的数据。如果未指定timeout，会马上返回，如果timeout是一个数字，则指定了阻塞的最大秒数，如果未指定timeout，那么将一直等待。</li>
<li>send_bytes(buffer,offset,size):通过连接发送buffer，offset是buffer中的偏移量，size是要发送的字节数。数据以一条完整的数据发送。</li>
<li>recv_bytes(maxlength):以字符串的形式返回一条从连接对象另一端发送过来的字节数据。此方法在接收到数据前一直阻塞。如果连接对象被关闭或没有数据可读取，将抛出异常。如果消息长度大于maxlength，则会抛出异常且该连接对象不可再读。</li>
<li>recv_bytes_into(buffer,offset):将一条完整的数据读入buffer中并返回消息的字节数，此方法在接收到数据前一直阻塞。如果连接对象被关闭或没有数据可读取，将抛出异常。offset指定buffer中放置消息处的字节偏移量。如果消息长度大于buffer将抛出导常。</li>
</ol>
<h4 id="使用管道">使用管道
</h4><p>管道可以在进程间传递数据。通常，一个连接会传递给一个子进程，而另一个连接保留在父进程中。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Process</span><span class="p">,</span> <span class="n">Pipe</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">child_process</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 子进程从连接中接收数据</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;He1lo from child&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span><span class="n">conn</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Received:&#39;</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 创建一个管道</span>
</span></span><span class="line"><span class="cl">    <span class="n">parent_conn</span><span class="p">,</span> <span class="n">child_conn</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 创建子进程</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">child_process</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">child_conn</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 父进程发送数据到子进程</span>
</span></span><span class="line"><span class="cl">    <span class="n">parent_conn</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&#34;hello from parent&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Received:&#39;</span><span class="p">,</span><span class="n">parent_conn</span><span class="o">.</span><span class="n">recv</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">#等待子进程结束</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="管道特点">管道特点
</h4><ol>
<li>双向通信:管道允许两个方向的通信，即每个管道有一个接收端和一个发送端.。</li>
<li>点对点连接:管道通常用于两个进程之间的直接通信，不支持多个进程之间的通信。</li>
<li>管道大小有限:管道的缓冲区大小是有限的。如果缓冲区满了，发送操作会阻塞。</li>
</ol>
<h4 id="注意事项">注意事项
</h4><ol>
<li>管道默认是双向的，但也可以通过设置dup1ex=Fa1se来创建单向管道。此时返回的第一个对象只能接收消息，第二个对象只能发送消息。</li>
<li>当使用管道在进程间传递大量数据时，要注意管道可能会成为性能瓶颈。</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Process</span><span class="p">,</span> <span class="n">Pipe</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sender</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span class="p">([</span><span class="mi">42</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="s1">&#39;Hi&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#创建一个单向管道</span>
</span></span><span class="line"><span class="cl">    <span class="n">parent_conn</span><span class="p">,</span> <span class="n">child_conn</span> <span class="o">=</span> <span class="n">Pipe</span><span class="p">(</span><span class="n">duplex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="消息队列queue">消息队列（Queue）
</h3><p>消息队列提供了一种在进程间传输数据的方式，这种方式是通过在内核中维护一个消息队列来实现的。进程可以发送数据到队列，也可以从队列中接收数据。在Python的mu1tiprocessing模块中，Queue 类提供了一个先进先出(FIFO)的消息队列。</p>
<h4 id="创建消息队列">创建消息队列
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Queue</span>
</span></span><span class="line"><span class="cl"><span class="c1">#创建一个消息队列</span>
</span></span><span class="line"><span class="cl"><span class="n">queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># maxsize为队列中最多可以存放的元素数量</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="消息队列的方法">消息队列的方法
</h4><p>在上面的例子中，queue是创建出来的消息队列，它拥有下面几种方法:</p>
<ol>
<li>put(obj，block=True，timeout=None):将obi放入队列，如果可选参数block是True而且timeout是None，将会阻塞当前进程，直到有空的缓冲槽。如果timeout是正数，将会在阻塞了最多timeout秒之后还是没有可用的缓冲槽时抛出异常。如果block是False，那么在没有空的缓冲槽时，会立即抛出异常，此时timeout会被忽略。</li>
<li>get(b1ock=True，timeout=None):从消息队列里获取消息。该方法为阻塞等待的方法。block和timeout的作用与put一致。</li>
<li>empty():如果队列为空，返回True，否则返回 False。</li>
<li>full() :如果队列满了，返回True，否则返回 False。</li>
<li>qsize():返回队列中当前元素的数量。</li>
<li>get_nowait():立即尝试从队列里获取一个元素，如果队列为空，抛出Queue.Empty异常</li>
<li>put_nowait():立即尝试从队列里放入一个元素，如果队列为空，抛出Queue.Full异常</li>
</ol>
<h4 id="在进程中使用消息队列">在进程中使用消息队列
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Queue</span><span class="p">,</span><span class="n">Process</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">process1</span><span class="p">(</span><span class="n">process_queue</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;准备接收数据&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;接收到的数据为：&#34;</span><span class="p">,</span><span class="n">process_queue</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">process_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">process1</span><span class="p">,</span><span class="n">arg</span><span class="o">=</span><span class="p">(</span><span class="n">process_queue</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">process_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s1">&#39;Hi&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="消息队列的特点">消息队列的特点
</h4><ol>
<li>先进先出(FIFO):队列遵循先进先出(FIFO)的原则，即先放入队列的元素会先被取出。</li>
<li>同步访问:queue 类提供了一系列同步方法，如 put()、get()等，以确保多进程对队列的访问是安全的。容量限制:队列可以指定最大容量，当队列满时，新元素将无法放入;当队列空时，试图从队列中获取元素的进程将阻塞，直到有新元素放入队列。</li>
<li>生产者-消费者模式:Queue 类非常适合用于生产者-消费者模式，其中生产者进程将数据放入队列，而消费者进程从队列中取出数据。</li>
</ol>
<h3 id="共享内存">共享内存
</h3><p>共享内存是一种进程间通信(IPC)机制，顾名思义，它允许多个进程访问同一块内存空间。每个进程都可以读取或写入这块内存，从而实现数据的共享。</p>
<h4 id="创建共享内存">创建共享内存
</h4><p>在Python中，共享内存分为两种，一种是共享一个变量，一种是共享一个数组。</p>
<ol>
<li>在Python中，使用multiprocessing.value(type_code，*args，1ock=True)来创建一个共享变量，其中type_code表示类型代码，*args表示初始化变量的值。lock表示锁，默认会创建一个锁用来保护共享变量。如果传入False，Value的实例就不会被锁保护，它将不是进程安全的。</li>
<li>在Python中，使用multiprocessing.Array(type_code,size_or_initializer,1ock=True)来创建-个共享数组，其中type_code表示类型代码，size_or_initializer表示数组的大小或初始化值，如果是一个整数，则表示数组的长度，且数组将被初始化为0，如果是一组序列，则就是数组的初始化值，其长度决定数组的长度。lock表示锁，默认会创建一个锁用来保护共享数组。</li>
</ol>
<div class="table-wrapper"><table>
  <thead>
      <tr>
          <th>类型代码</th>
          <th>映射</th>
          <th>描述</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>&lsquo;b&rsquo;</td>
          <td>ctypes.c_byte</td>
          <td>有符号字节（8位）</td>
      </tr>
      <tr>
          <td>&lsquo;B&rsquo;</td>
          <td>ctypes.c_ubyte</td>
          <td>无符号字节（8位）</td>
      </tr>
      <tr>
          <td>&lsquo;h&rsquo;</td>
          <td>ctypes.c_short</td>
          <td>有符号短整型（16位）</td>
      </tr>
      <tr>
          <td>&lsquo;H&rsquo;</td>
          <td>ctypes.c_ushort</td>
          <td>无符号短整型（16位）</td>
      </tr>
      <tr>
          <td>&lsquo;i&rsquo;</td>
          <td>ctypes.c_int</td>
          <td>有符号整型（32位）</td>
      </tr>
      <tr>
          <td>&lsquo;I&rsquo;</td>
          <td>ctypes.c_uint</td>
          <td>无符号整型（32位）</td>
      </tr>
      <tr>
          <td>&rsquo;l'</td>
          <td>ctypes.c_long</td>
          <td>有符号长整型（32位）</td>
      </tr>
      <tr>
          <td>&lsquo;L&rsquo;</td>
          <td>ctypes.c_ulong</td>
          <td>无符号长整型（32位）</td>
      </tr>
      <tr>
          <td>&lsquo;q&rsquo;</td>
          <td>ctypes.c_longlong</td>
          <td>有符号长长整型（64位）</td>
      </tr>
      <tr>
          <td>&lsquo;Q&rsquo;</td>
          <td>ctypes.c_ulonglong</td>
          <td>无符号长长整型（64位）</td>
      </tr>
      <tr>
          <td>&lsquo;f&rsquo;</td>
          <td>ctypes.c_float</td>
          <td>单精度浮点数（32位）</td>
      </tr>
      <tr>
          <td>&rsquo;d'</td>
          <td>ctypes.c_double</td>
          <td>双精度浮点数（64位）</td>
      </tr>
  </tbody>
</table></div>
<h4 id="共享内存的方法">共享内存的方法
</h4><ol>
<li>value：对于value对象，其属性用于获取或设置共享变量的值</li>
<li>[:]‘: 对于Array对象，可以使用切片操作来获取或修改数组中的元素。</li>
</ol>
<h4 id="共享内存的使用">共享内存的使用
</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span>  <span class="n">Process</span><span class="p">,</span><span class="n">Value</span><span class="p">,</span><span class="n">Array</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">shared_num</span><span class="p">,</span><span class="n">shared_array</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">shared_num</span><span class="o">.</span><span class="n">value</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shared_array</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">shared_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">shared_num</span> <span class="o">=</span> <span class="n">Value</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">shared_array</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">shared_num</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">shared_array</span><span class="p">[:])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">func</span><span class="p">,</span><span class="n">args</span><span class="o">=</span> <span class="p">(</span><span class="n">shared_num</span><span class="p">,</span><span class="n">shared_array</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">shared_num</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">shared_array</span><span class="p">[:])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="共享内存的特点">共享内存的特点
</h4><ol>
<li><strong>高效的数据共享</strong>:共享内存比其他IPC机制(如消息队列)更高效，因为它避免了数据的复制。。</li>
<li><strong>同步问题</strong>:共享内存需要同步机制(如锁)来防止竞态条件</li>
<li><strong>类型限制</strong>:共享内存的数据类型有限，通常只能是基本数据类型。</li>
</ol>
<h2 id="进程同步">进程同步
</h2><p>在Python中，进程同步是指在多进程环境下协调各个进程对共享资源的访问，主要解决的问题是当多个进程并发访问共享资源时，如何确保任一时刻只有一个进程能够访问该资源，从而避免由于进程间的无序竞争而导致的系统资源冲突，确保系统的稳定运行。进程同步通常涉及到以下几个核心概念:</p>
<ol>
<li>临界资源是指一段时间内仅允许一个进程访问的资源，这可能是硬件资源，也可能是软件资源如变量、数据.表格、队列等</li>
<li>临界区是指访问临界资源的那部分代码。在进入临界区之前，需要检査是否可以访问临界资源，以确保资源的互斥访问。</li>
</ol>
<p>进程同步的机制应遵循以下规则:</p>
<ol>
<li>空则让进:如果临界资源处于空闲状态，则进程可以进入其临界区。</li>
<li>忙则等待:如果临界资源正在被使用，则请求访问的进程需要等待。
常见的进程同步机制包括锁、信号量、事件、条件变量等。</li>
</ol>
<h3 id="锁">锁
</h3><p>锁(Lock)是一种用于控制多个进程访问共享资源的机制，锁的主要目的是防止多个进程同时访问共享资源时可能产生的竞态条件(Race Condition)，确保数据的一致性和完整性。在Pvthon中，最常用的锁为互斥锁(Lock)和递归锁(RLock)</p>
<h4 id="互斥锁">互斥锁
</h4><p>这是最常见的一种锁，它确保同一时间只有一个进程可以访问共享资源。当一个进程正在使用资源时，它会锁定该资源，其他进程必须等待锁被释放后才能访问。在mu1tiprocessing模块中，Lock对象可以用来确保临界区代码的互斥执行。</p>
<p>方法:</p>
<ol>
<li>acquire(blocking=True，timeout=-1):尝试获取锁。如果b1ocking为True 并且timeout 是默认值 -1，该方法会阻塞直到锁被获取。如果 b1ocking为 False，则立即返回而不阻塞。</li>
<li>release():释放锁</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">multiprocessing</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Queue</span><span class="p">,</span><span class="n">current_process</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#定义一个task函数，它将用于创建进程</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">task</span><span class="p">(</span><span class="n">lock</span><span class="p">,</span><span class="n">queue</span><span class="p">,</span><span class="n">amount</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#获取一个锁</span>
</span></span><span class="line"><span class="cl">        <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span> <span class="c1"># 上锁</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#从队列中获取当前的余额</span>
</span></span><span class="line"><span class="cl">        <span class="n">money</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#检查余额是否足够</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">money</span> <span class="o">&gt;=</span> <span class="n">amount</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#余额足够，进行取款</span>
</span></span><span class="line"><span class="cl">            <span class="n">money</span> <span class="o">-=</span> <span class="n">amount</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">current_process</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">取出</span><span class="si">{</span><span class="n">amount</span><span class="si">}</span><span class="s1">,现在还有</span><span class="si">{</span><span class="n">money</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">current_process</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">余额不足&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#释放锁，允许其他进程操作</span>
</span></span><span class="line"><span class="cl">            <span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#将跟新后的余额放回队列</span>
</span></span><span class="line"><span class="cl">            <span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">money</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">money</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">count</span> <span class="o">=</span> <span class="mi">1000</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#定义互斥锁</span>
</span></span><span class="line"><span class="cl">    <span class="n">lock</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#创建两个进程</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">lock</span><span class="p">,</span><span class="n">queue</span><span class="p">,</span><span class="mi">50</span><span class="p">),</span><span class="n">name</span><span class="o">=</span> <span class="s1">&#39;ZS&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">t2</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">task</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">lock</span><span class="p">,</span><span class="n">queue</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span><span class="n">name</span><span class="o">=</span> <span class="s1">&#39;LS&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">t2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">t1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">t2</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="递归锁">递归锁
</h4><p>递归锁与互斥锁最大的不同就是它允许同一个进程多次获取同一把锁，这意味着如果一个进程获取了锁，它还可以再次获取锁而不会导致死锁。但是该锁的内部有一个计数器，每当一个进程获取到锁时，计数器就会增加，当进程释放锁时，计数器就会减少。只有当计数器为0时，锁才会真正释放，才会允许其他的进程去获取锁，其他的使用和互斥锁一模一样。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing.dummy</span> <span class="kn">import</span> <span class="n">current_process</span><span class="p">,</span><span class="n">Queue</span><span class="p">,</span> <span class="n">RLock</span><span class="p">,</span><span class="n">Process</span>
</span></span><span class="line"><span class="cl"><span class="c1">#定义一个函数，它会不断向队列中添加数据</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">producer</span><span class="p">(</span><span class="n">queue</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&#34;HI&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#定义一个函数，它会不断从队列中取出数据</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">consumer</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span><span class="n">lock</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#time.sleep(2)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">#检查队列是否为空</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="ow">not</span> <span class="n">queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">current_process</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#定义一个递归锁，保证所有内容</span>
</span></span><span class="line"><span class="cl">    <span class="n">lock</span> <span class="o">=</span> <span class="n">RLock</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">producer1</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">producer</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">queue</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">producer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">consumer1</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">consumer</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span><span class="n">lock</span><span class="p">,),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;consumer1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">consumer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">consumer2</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">consumer</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">queue</span><span class="p">,</span><span class="n">lock</span><span class="p">,),</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;consumer2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">consumer2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">producer1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">consumer1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">consumer2</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="信号量">信号量
</h3><p>信号量是一个更高级的同步机制，它内部维护任个计数器，用于控制对共享资源的最大并发访问数量。在multiprocessing模块中，semaphore对象用于此类同步，</p>
<p>multiprocessing.semaphore(value=1):创建一个信号量对象，value 参数指定了初始可用的数量，默认为1。</p>
<p>信号量的方法:</p>
<ol>
<li>acquire([timeout=None]):尝试获取信号量。如果信号量可用，则其值减一并立即返回 True。如果信号量不可用，则阻塞直到超时或信号量变为可用。如果没有指定timeout或timeout为None，则一直等待直至信号量可用。</li>
<li>release():释放一个信号量，其值加一。如果信号量之前已被阻塞，则会唤醒一个正在等待的进程</li>
</ol>
<h3 id="事件">事件
</h3><p>事件是一种简单的同步机制，允许一个进程通知一个或多个等待的进程某些事件已经发生，也就是发送一个信号而其他进程可以根据这个信号做出反应。Event对象的使用场景:</p>
<ol>
<li>一个进程等待另一个进程完成某项任务。</li>
<li>控制多个进程间的简单通信。</li>
<li>实现对共享资源的访问控制。</li>
</ol>
<p>在Python中使用multiprocessing.Event 创建事件对象，其基本方法有:</p>
<ol>
<li>is_set():返回事件是否已设置的状态，如果被设置则返回True，否则返回 False。</li>
<li>set():将事件设置为真状态，即 True ，表示可以唤醒正在等待该事件的所有线程或进程。</li>
<li>clear():将事件设置为假状态，即 Fa1se，表示没有线程或进程会被唤醒。</li>
<li>wait([timeout]):阻塞当前进程直到事件被设置为真状态或超时(如果提供了timeout 参数)。</li>
</ol>
<p>如果没有设置超时时间，则会一直等待直到事件被设置。事件的使用分为两种情况:</p>
<ol>
<li>事件只被唤醒一次，然后开始进行自己的工作。</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Event</span><span class="p">,</span><span class="n">Process</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">scipy.special.cython_special</span> <span class="kn">import</span> <span class="n">powm1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">producer</span><span class="p">(</span><span class="n">start_event</span><span class="p">,):</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">consumer1</span><span class="p">(</span><span class="n">start_event</span><span class="p">,):</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">consumer2</span><span class="p">(</span><span class="n">start_event</span><span class="p">,):</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">consumer3</span><span class="p">(</span><span class="n">start_event</span><span class="p">,):</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">start_event</span> <span class="o">=</span> <span class="n">Event</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">p1</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">producer</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">start_event</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">p1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">c1</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">consumer1</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">start_event</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">c1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">c2</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">consumer2</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">start_event</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">c2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">c3</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">consumer3</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">start_event</span><span class="p">,))</span>
</span></span><span class="line"><span class="cl">    <span class="n">c3</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">p1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">c1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">c2</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">c3</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="进程池">进程池
</h2><p>进程池是一组预先创建的空闲进程，它们等待执行任务，主进程负责将任务分配给进程池中的空闲进程去执行。进程池可以管理进程的创建和销毁，避免了频繁地创建和销毁进程带来的开销，通过进程池可以轻松的实现多任务的
并行处理。</p>
<h3 id="为什么使用进程池">为什么使用进程池
</h3><ol>
<li>效率:相比于手动创建和管理多个进程，使用进程池可以更高效地利用系统资源。</li>
<li>简化:进程池简化了并行编程的复杂性，开发者不需要关注进程的创建和销毁细节。</li>
<li>控制:可以限制同时运行的进程数量，防止系统资源被过度消耗。</li>
</ol>
<h3 id="进程池的创建">进程池的创建
</h3><p>在Python中，进程池的创建有两种方式。</p>
<h4 id="使用multiprocessing库">使用multiprocessing库
</h4><p>在Python中，使用multiprocessing 模块中的Pool创建进程池:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">multiprocessing.Pool</span>
</span></span><span class="line"><span class="cl"><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">initializer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">initargs</span><span class="o">=</span><span class="p">(),</span><span class="n">maxtasksperchild</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>参数解释：</p>
<ol>
<li>processes:进程池中的进程数。如果processes为None，则默认使用系统的处理器核心数。。</li>
<li>initializer:每个工作进程启动时要执行的可调用对象，默认为None。如果是None，则调用initializer(*initargs)。</li>
<li>initargs:传递给initializer的可变参数元组。</li>
<li>maxtasksperchild:工作进程退出之前可以完成的任务数，完成后用一个新的工作进程来替代原进程，来让闲置的资源被释放。maxtasksperchild默认是None，意味着只要Pool存在工作进程就会一直存活。</li>
</ol>
<h4 id="使用concurrentfutures库">使用concurrent.futures库
</h4><p>在Python中，使用concurrent.futures的ProcessPoolExecutor创建进程池。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">concurrent</span><span class="o">.</span><span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mp_context</span><span class="o">=</span><span class="kc">None</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">initializer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">initargs</span><span class="o">=</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>参数解释：</p>
<ol>
<li>max_workers:指定进程池中可以同时运行的最大进程数。如果设置为 Non列或未指定，则默认为机器的处理器数量，最多为61。</li>
<li>mp_context:指定多进程上下文。默认情况下，ProcessPoolExecutor 使用multiprocessing.get_context()来获取上下文。这允许你选择不同的上下文，例如 spawn、 fork.forkserver 等，这些上下文可能提供不同的功能，如更好的资源隔离、更好的安全性等。</li>
<li>initializer:一个可选的可调用对象，每个工作进程在启动时都会调用它。这可以用来执行进程的初始化操作，例如设置进程局部存储。</li>
<li>initargs:一个元组，其中包含传递给 initializer 的参数。</li>
</ol>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">相关文章</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/Mybolg/p/python-%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/">
        
        
            <div class="article-image">
                
                    <img src="/Mybolg/images/PythonCourse/R-C.png" loading="lazy" data-key="" data-hash="/Mybolg/images/PythonCourse/R-C.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Python-排序算法</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Mybolg/p/python-%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
        
        
            <div class="article-image">
                
                    <img src="/Mybolg/images/PythonCourse/R-C.png" loading="lazy" data-key="" data-hash="/Mybolg/images/PythonCourse/R-C.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Python-数据结构</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Mybolg/p/python-%E5%A4%9A%E7%BA%BF%E7%A8%8B/">
        
        
            <div class="article-image">
                
                    <img src="/Mybolg/images/PythonCourse/R-C.png" loading="lazy" data-key="" data-hash="/Mybolg/images/PythonCourse/R-C.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Python-多线程</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Mybolg/p/python%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/">
        
        
            <div class="article-image">
                
                    <img src="/Mybolg/images/PythonCourse/R-C.png" loading="lazy" data-key="" data-hash="/Mybolg/images/PythonCourse/R-C.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Python文件操作</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/Mybolg/p/python%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">
        
        
            <div class="article-image">
                
                    <img src="/Mybolg/images/PythonCourse/R-C.png" loading="lazy" data-key="" data-hash="/Mybolg/images/PythonCourse/R-C.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Python的正则表达式</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2024 UPPO
    </section>
    
    <section class="powerby">
        使用 <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> 构建 <br />
        主题 <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.27.0">Stack</a></b> 由 <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> 设计
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/Mybolg/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

<script>
    
    const cssPath = "https://UPPO8.github.io/Mybolg/waifu/waifu.css"
    const tipsJsonPath = "https://UPPO8.github.io/Mybolg/waifu/waifu-tips.json"
    
    const live2d_path = "https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/";

    
    function loadExternalResource(url, type) {
        return new Promise((resolve, reject) => {
            let tag;
            if (type === "css") {
                tag = document.createElement("link");
                tag.rel = "stylesheet";
                tag.href = url;
            }
            else if (type === "js") {
                tag = document.createElement("script");
                tag.src = url;
            }
            if (tag) {
                tag.onload = () => resolve(url);
                tag.onerror = () => reject(url);
                document.head.appendChild(tag);
            }
        });
    }

    
    if (screen.width >= 768) {
        Promise.all([
        loadExternalResource(cssPath, "css"),
            loadExternalResource(live2d_path + "live2d.min.js", "js"),
            loadExternalResource(live2d_path + "waifu-tips.js", "js")
        ]).then(() => {
            initWidget({
                waifuPath: tipsJsonPath,
                cdnPath: "https://fastly.jsdelivr.net/gh/fghrsh/live2d_api/",
                tools: ["hitokoto", "asteroids", "switch-model", "switch-texture", "photo", "info", "quit"]
            });
            
            initWaifuMouseEvent();
        });
    }
    function initWaifuMouseEvent() {
        const waifu = document.getElementById("waifu");
        let isDown = false;
        let waifuLeft;
        let mouseLeft;
        let waifuTop;
        let mouseTop;
        
        waifu.onmousedown = function (e) {
            isDown = true;
            
            waifuLeft = waifu.offsetLeft;
            mouseLeft = e.clientX;
            
            waifuTop = waifu.offsetTop;
            mouseTop = e.clientY;
        }
        
        window.onmousemove = function (e) {
            if (!isDown) {
                return;
            }
            
            let currentLeft = waifuLeft + (e.clientX - mouseLeft);
            if (currentLeft < 0) {
                currentLeft = 0;
            } else if (currentLeft > window.innerWidth - 300) {
                currentLeft = window.innerWidth - 300;
            }
            waifu.style.left = currentLeft  + "px";
            
            
            
            
            
            
            
            
            
            
        }
        
        window.onmouseup = function (e) {
            isDown = false;
        }
    }
</script>

    </body>
</html>
